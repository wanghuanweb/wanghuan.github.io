function Calendar(a){this.options=a,console.log(this.options);var b=new Date;this.input=document.querySelector("[data-calendar]"),this.year=b.getFullYear(),this.month=b.getMonth()+1,this.day=b.getDate(),this.init()}Calendar.prototype={init:function(){this.initDom(),this.initProperty(),this.paint(this.year,this.month),this.initEvent()},initEvent:function(){var a=this;this.input.onfocus=function(){document.querySelector("#calendar").style.display="block"},document.querySelector("#year").addEventListener("change",function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,p;if(0===this.selectedIndex){for(b=new Date,c=b.getMonth()+1,d=b.getDate(),document.querySelector("#month").innerHTML="",e=c;13>e;e++)f=document.createElement("option"),f.value=e,f.innerHTML=e,document.querySelector("#month").appendChild(f);for(a.day=d,g=document.querySelector("#calendar"),h=document.querySelector("#year"),i=h.selectedIndex,j=h[i].text,k=document.querySelector("#month"),l=k.selectedIndex,m=k[l].text,n=this.selectedIndex,this[n].text,a.year=this[n].text,g.removeChild(g.lastChild),a.paint(j,m),p=document.getElementsByClassName("used").length+1,document.querySelector("#day").innerHTML="",e=d;p>e;e++)f=document.createElement("option"),f.value=e,f.innerHTML=e,document.querySelector("#day").appendChild(f);a.input.value=j+"-"+c+"-"+a.day}else a.updateMonth(),a.day=1,a.month=1,g=document.querySelector("#calendar"),h=document.querySelector("#year"),i=h.selectedIndex,j=h[i].text,k=document.querySelector("#month"),l=k.selectedIndex,m=k[l].text,n=this.selectedIndex,this[n].text,a.year=this[n].text,g.removeChild(g.lastChild),a.paint(j,m),a.updateDay(),a.input.value=j+"-"+m+"-"+a.day},!1),document.querySelector("#month").addEventListener("change",function(){var k,l,n,o,p,q,b=document.querySelector("#calendar"),c=document.querySelector("#year"),d=c.selectedIndex,e=c[d].text,f=document.querySelector("#month"),g=f.selectedIndex,h=f[g].text,i=this.selectedIndex;if(this[i].text,a.month=this[i].text,b.removeChild(b.lastChild),a.paint(e,h),a.input.value=e+"-"+h+"-"+a.day,k=new Date,l=k.getFullYear(),k.getMonth()+1,n=k.getDate(),l==a.year&&0===this.selectedIndex){for(o=document.getElementsByClassName("used").length+1,console.log(o),document.querySelector("#day").innerHTML="",p=n;o>p;p++)q=document.createElement("option"),q.value=p,q.innerHTML=p,document.querySelector("#day").appendChild(q);a.day=n}else a.updateDay(),a.day=1},!1),document.querySelector("#day").addEventListener("change",function(){var b=document.querySelector("#calendar"),c=document.querySelector("#year"),d=c.selectedIndex,e=c[d].text,f=document.querySelector("#month"),g=f.selectedIndex,h=f[g].text,i=this.selectedIndex,j=this[i].text;a.day=this[i].text,b.removeChild(b.lastChild),a.paint(e,h),a.input.value=e+"-"+h+"-"+j,b.style.display="none"},!1)},initProperty:function(){var a=this.year+"-"+this.month+"-"+this.day;this.input.value=a},initDom:function(){var b,c,d,e,f,g,h,i,j,k,l,a=document.createElement("div");for(a.id="calendar",a.className=this.options.calendarClass,a.style.display="none",b=document.createElement("div"),c=document.createElement("select"),c.id="year",f=2017;2030>f;f++)d=document.createElement("option"),d.value=f,d.innerHTML=f,c.appendChild(d);for(e=document.createElement("select"),e.id="month",f=this.month;13>f;f++)d=document.createElement("option"),d.value=f,d.innerHTML=f,e.appendChild(d);for(g=document.createElement("select"),g.id="day",h=this.getMonthLength(),f=this.day;h>f;f++)d=document.createElement("option"),d.value=f,d.innerHTML=f,g.appendChild(d);b.appendChild(c),i=document.createElement("label"),i.innerHTML="年",b.appendChild(i),b.appendChild(e),j=document.createElement("label"),j.innerHTML="月",b.appendChild(j),b.appendChild(g),k=document.createElement("label"),k.innerHTML="日",b.appendChild(k),a.appendChild(b),l=this.input.nextElementSibling,document.body.insertBefore(a,l)},paint:function(a,b){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,c=document.querySelector("#calendar"),d=document.createElement("table");for(this.arr,f=document.createElement("tr"),f.innerHTML="<th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th>",d.appendChild(f),g=this.getArrHeight(a,b),h=this.getMonthLength(a,b),i=this.getFirstDay(a,b),j=this.getMonthLength(a,b-1),k=[],l=i;l>0;l--)k.push(j-l);for(m=this.options.cellClass,n=m+" "+this.options.uesdClass,o=1,p=1,l=0;g>l;l++){for(q=document.createElement("tr"),r=0;7>r;r++)s=document.createElement("td"),0==l?i>r?(s.innerHTML=k.shift(),s.className=m):(s.innerHTML=o++,s.className=n,s.innerHTML==this.day&&(s.className+=" active")):l==g-1?h>=o?(s.innerHTML=o++,s.className=n,s.innerHTML==this.day&&(s.className+=" active")):(s.innerHTML=p++,s.className=m):(s.innerHTML=o++,s.className=n,s.innerHTML==this.day&&(s.className+=" active")),q.appendChild(s);d.appendChild(q)}c.appendChild(d)},updateMonth:function(){var a,b;for(document.querySelector("#month").innerHTML="",a=1;13>a;a++)b=document.createElement("option"),b.value=a,b.innerHTML=a,document.querySelector("#month").appendChild(b)},updateDay:function(){var b,c,a=document.getElementsByClassName("used").length+1;for(document.querySelector("#day").innerHTML="",b=1;a>b;b++)c=document.createElement("option"),c.value=b,c.innerHTML=b,document.querySelector("#day").appendChild(c)},nextMonth:function(){12==this.month?(this.year=this.year+1,this.month=1):this.month=this.month+1},lastMonth:function(){1==this.month?(this.year=this.year-1,this.month=12):this.month=this.month-1},getMonthLength:function(a,b){return a=a||(new Date).getFullYear(),b=b||(new Date).getMonth()+1,new Date(a,b,0).getDate()},getFirstDay:function(a,b){return a=a||(new Date).getFullYear(),b=b||(new Date).getMonth()+1,new Date(a,b-1,1).getDay()},getArrHeight:function(a,b){var c=this.getMonthLength(a,b),d=this.getFirstDay(a,b),e=Math.ceil((d+c)/7);return e}};